'use strict';define(function(){"use strict";function a(){if(!(0<b.length))for(var a=Math.sqrt(2*Math.log(2)/Math.log(Math.E)),e=0;e<=d*c;e++)b[e]=Math.exp(-1/2*Math.pow(2*(e-c*d/2)/d*a,2))}var b=[],c=5,d=1e3,e=function(a){return 1+3*a/1e3};return function(f){a(),f=f||{},this.maxTime=f.maxTime||3600,this.nbPointsPerSecond=f.nbPointsPerSecond||5,this.getWidth=f.getWidth||e,this.annotations=[],this.spectrum=[];for(var g=2*(this.maxTime*this.nbPointsPerSecond);0<=g;g-=2)this.spectrum[g]=g/this.nbPointsPerSecond/2,this.spectrum[g+1]=0;this.appendPeaks=function(a,b,c){for(var d=0;d<a.length;d++)this.appendPeak(a[d],b,c)},this.appendAnnotation=function(a,b,c,d,e){e=e||{};var f={};f.type="rect",f._highlight=[c.valueOf()],f.pos={x:a,y:(e.y||30)+"px"},f.pos2={x:b,y:(e.y||30)+(e.height||30)+"px"},f.fillColor="#EEEEEE",f.strokeColor="#CC0000",f.strokeWidth="0px",f.info=d,this.annotations.push(f)},this.random=function(a,b){for(var c,b=b||1,d=0;d<a;d++){c=Math.random()*b+1;for(var e=0;e<c;e++){var f=Math.floor(Math.random()*this.maxTime),g=Math.random();this.appendPeak([f,g],d)}}},this.appendPeak=function(a,e,f){for(var g,h=a[0],i=a[1],k=this.getWidth(h),l=h-k,m=h+k,n=Math.max(Math.ceil((h-k/2*c)*this.nbPointsPerSecond),0),o=Math.min(Math.floor((h+k/2*c)*this.nbPointsPerSecond),this.spectrum.length/2-1),p=n;p<=o;p++)g=Math.floor(d/k*(p-(n+o)/2)/this.nbPointsPerSecond+c*d/2),0<=g&&g<b.length&&(this.spectrum[2*p+1]+=b[g]*i);e&&this.appendAnnotation(l,m,e,{peak:a},f)},this.getSpectrum=function(){return this.spectrum},this.getAnnotations=function(a){a=a||{};var b=this.annotations;return a.minIntensity&&(b=b.filter(function(b){return b.info&&b.info.peak[1]>a.minIntensity})),b}}});
